
const tabsContainer = document.querySelector(".faq");
const tabsList = tabsContainer.querySelector(".faq__list");
const tabButtons = tabsList.querySelectorAll(".faq__link");
const tabPanels = tabsContainer.querySelectorAll(".faq__panels > div");

tabsList.setAttribute("role", "tablist");

tabsList.querySelectorAll("li").forEach((listitem) => {
  listitem.setAttribute("role", "presentation");
});

tabButtons.forEach((tab, index) => {
  tab.setAttribute("role", "tab");
  tab.setAttribute("aria-selected", "false"); // Змінено значення на "false"
  tab.setAttribute("tabindex", "-1");
  tabPanels[index].setAttribute("hidden", "true"); // Змінено значення на "true"
});


tabPanels.forEach((panel) => {
  panel.setAttribute("role", "tabpanel");
  panel.setAttribute("tabindex", "0");
});

tabsContainer.addEventListener("click", (e) => {
  const clickedTab = e.target.closest(".faq__link");
  if (!clickedTab) return;
  e.preventDefault();

  switchTab(clickedTab);
});

tabsContainer.addEventListener("keydown", (e) => {
  switch (e.key) {
    case "ArrowLeft":
      moveLeft();
      break;
    case "ArrowRight":
      moveRight();
      break;
    case "Home":
      e.preventDefault();
      switchTab(tabButtons[0]);
      break;
    case "End":
      e.preventDefault();
      switchTab(tabButtons[tabButtons.length - 1]);
      break;
  }
});

function moveLeft() {
  const currentTab = document.activeElement;
  if (!currentTab.parentElement.previousElementSibling) {
    switchTab(tabButtons[tabButtons.length - 1]);
  } else {
    switchTab(
      currentTab.parentElement.previousElementSibling.querySelector("a")
    );
  }
}

function moveRight() {
  const currentTab = document.activeElement;
  if (!currentTab.parentElement.nextElementSibling) {
    switchTab(tabButtons[0]);
  } else {
    switchTab(currentTab.parentElement.nextElementSibling.querySelector("a"));
  }
}

// function switchTab(newTab) {
//   const activePanelId = newTab.getAttribute("href");
//   const activePanel = tabsContainer.querySelector(activePanelId);

//   tabButtons.forEach((button) => {
//     button.setAttribute("aria-selected", false);
//     button.setAttribute("tabindex", "-1");
//   });

//   tabPanels.forEach((panel) => {
//     panel.setAttribute("hidden", true);
//   });

//   activePanel.removeAttribute("hidden", false);

//   newTab.setAttribute("aria-selected", true);
//   newTab.setAttribute("tabindex", "0");
//   newTab.focus();
// }


function switchTab(newTab) {
  const isActive = newTab.getAttribute("aria-selected") === "true";

  if (isActive) {
    // Якщо вкладка вже активна, закрити її
    newTab.setAttribute("aria-selected", "false");
    newTab.setAttribute("tabindex", "-1");
    tabsContainer.querySelector(newTab.getAttribute("href")).setAttribute("hidden", "true");
  } else {
    // В іншому випадку, виконати звичайну логіку перемикання
    const activePanelId = newTab.getAttribute("href");
    const activePanel = tabsContainer.querySelector(activePanelId);

    tabButtons.forEach((button) => {
      button.setAttribute("aria-selected", false);
      button.setAttribute("tabindex", "-1");
    });

    tabPanels.forEach((panel) => {
      panel.setAttribute("hidden", true);
    });

    activePanel.removeAttribute("hidden", false);

    newTab.setAttribute("aria-selected", true);
    newTab.setAttribute("tabindex", "0");
    newTab.focus();
  }
}
